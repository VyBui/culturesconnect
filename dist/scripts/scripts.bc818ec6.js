"use strict";angular.module("herokuTestApp",["ngAnimate","ngCookies","ngResource","ngRoute","ui.router","ngSanitize","angular-flexslider","parse-angular","ngDialog","LocalStorageModule","directive.g+signin"]).run(["$rootScope","$state","$stateParams",function(a,b,c){a.$state=b,a.$stateParams=c,a.$on("$stateChangeStart",function(b,c,d){var e=c.data.requireLogin,f=Parse.User.current();console.log(f),e&&null===f?b.preventDefault():a.currentUser=f})}]).config(["$routeProvider","$stateProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/searchExperience",{templateUrl:"views/experience/experience.html",controller:"AboutCtrl",controllerAs:"about"}).when("/UserauthenticationCtrl",{templateUrl:"views/experience/experience.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("herokuTestApp").controller("MainCtrl",["$scope","getDataMainPart2Part2",function(a,b){a.loadImageForSlider=function(){b.getDatabaseP1().then(function(b){a.databasePart1=angular.copy(b.dataMainPagePart1),"undefined"!=typeof a.databasePart1.images&&(a.slides=a.databasePart1.images)})["finally"](function(){})},a.loadWhyChooseUs=function(){b.getDatabaseP2().then(function(b){var c="secondary";"undefined"!=typeof b&&(a.databasepart2=angular.copy(b),0==c.localeCompare("primary")?console.log("do nothing"):a.WhyChooseUs=a.databasepart2.VietNamese,a.provines=a.databasepart2.provines,a.experienceTypes=a.databasepart2.experienceTypes)})},a.clickToOpen=function(){console.log("vao day"),ngDialog.open({template:"popupTmpl.html",plain:!0})}}]),angular.module("herokuTestApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("herokuTestApp").service("getDataMainPart2Part2",["$http","$q",function(a,b){var c={};return c.getDatabaseP1=function(){var c=b.defer();return a({method:"GET",url:"../scripts/database.json",cache:!0}).success(function(a,b,d,e){"undefined"!=typeof a&&c.resolve(a)}).error(function(a){c.reject(a)}),c.promise},c.getDatabaseP2=function(){var c=b.defer();return a({method:"GET",url:"../scripts/database.json",cache:!0}).success(function(a,b,d,e){"undefined"!=typeof a&&c.resolve(a.dataMainPagePart2)}).error(function(a){c.reject(a)}),c.promise},c}]),angular.module("herokuTestApp").directive("mainSliderImage",function(){return{restrict:"A",link:function(a,b,c){}}}),angular.module("herokuTestApp").directive("addImage",function(){return{template:"<div></div>",restrict:"E",link:function(a,b,c){b.text("this is the addImage directive")}}}),angular.module("herokuTestApp").controller("HeaderCtrl",["$scope","ngDialog","AuthService",function(a,b,c){a.clickToOpen=function(a){b.open({template:"views/modal.html",className:"ngdialog-theme-default ngdialog-theme-custom",controller:"UsersCtrl",resolve:{option:function(){return a}}})},a.loading=function(){a.checkLogin()},a.checkLogin=function(){a.currentUser=Parse.User.current(),null===a.currentUser||"undefined"!=typeof a.currentUser.attributes.authData.facebook&&console.log(a.currentUser)}}]),angular.module("herokuTestApp").service("myService",function(){}),angular.module("herokuTestApp").factory("AuthService",["$rootScope","$http","$q","$state","localStorageService",function(a,b,c,d,e){var f={};return f.storeUserCredentials=function(a){e.remove("currentUser"),e.set("currentUser",a)},f.getUserCredentials=function(){return e.get("currentUser")},f.removeUserCredentials=function(){e.remove("currentUser"),e.clearAll()},f.removeAll=function(){e.clearAll()},f.getUserByUserId=function(a){var b=c.defer(),d=new Parse.Query("User");return d.get(a,{success:function(a){b.resolve(a)},error:function(a){b.reject(a)}}),b.promise},f.getUserByUserName=function(a){var b=c.defer(),d=new Parse.Query("User");return d.equalTo("username",a),d.find({success:function(a){b.resolve(a[0])},error:function(a){b.reject(a)}}),b.promise},f.editUserAccountTwo=function(a){var b=c.defer(),d=new Parse.Query("User");return d.equalTo("objectId",a.id),d.first().then(function(c){c.set("first_name",a.first_name),c.set("last_name",a.last_name),"undefined"!=typeof a.newPassword&&" "!==a.newPassword&&c.set("password",a.newPassword),c.set("email",a.email),c.set("username",a.email),c.set("address",a.address),c.set("city",a.city),c.set("state",a.state),c.set("zipcode",parseInt(a.zipcode)),c.save(null,{success:function(a){b.resolve(a)},error:function(a){b.reject(a)}})}),b.promise},f.authenticate=function(a){var b=c.defer(),d=new Parse.Query(Parse.User);return d.whereEqualTo("user",a),d.find({success:function(a){console.log(a),b.resolve(a)},error:function(a){b.reject(a)}}),b.promise},f.getFacebookStatus=function(){var a=c.defer(),b={id:0,accessToken:0,status:null};FB.getLoginStatus(function(c){return"connected"===c.status?(b.id=c.authResponse.userID,b.accessToken=c.authResponse.accessToken):"not_authorized"===c.status&&(b.status="not_authorized"),a.resolve(b),a.promise})},f}]),angular.module("herokuTestApp").controller("UsersCtrl",["$rootScope","$scope","$state","$http","AuthService","$window","option",function(a,b,c,d,e,f,g){b.signUp=function(a){var c=new Parse.User;c.set("username",a.testEmail.toLowerCase()),c.set("email",a.testEmail.toLowerCase()),c.set("password",a.password),c.set("first_name",a.first_name),b.delay=0,b.minDuration=10,b.message="Please Wait...",b.backdrop=!0,b.promise=d.get("http://httpbin.org/delay/3"),c.signUp(null,{success:function(a){console.log("user day"),console.log(a),b.promise=null,b.$apply();var c=new Parse.ACL;c.setPublicReadAccess(!1),c.setPublicWriteAccess(!1),c.setWriteAccess(a.id,!0),c.setReadAccess(a.id,!0),a.setACL(c)},error:function(a,c){c.message==="username "+a.get("email")+" already taken"&&(b.existEmail=a.get("email"))}})},b.logIn=function(a){b.delay=0,b.minDuration=10,b.message="Please Wait...",b.backdrop=!0,b.promise=d.get("http://httpbin.org/delay/3"),Parse.User.logIn(a.email.toLowerCase(),a.password,{success:function(a){c.go("app.dashboard"),b.loginForgot=null,b.promise=null},error:function(a,c){("101"===c.code||101===parseInt(c.code))&&(b.loginForgot=!0,b.promise=null)}})},b.loginWithFacebook=function(){Parse.FacebookUtils.logIn(null,{success:function(a){a.existed()||FB.api("/me?fields=id,name,email,permissions",function(b){a.set("username",b.name),a.set("email",b.email),a.save()})},error:function(a,b){alert("User cancelled the Facebook login or did not fully authorize.")}})},b.logOut=function(){Parse.User.logOut(),f.reload()},b.forgotMessage="Enter your email address and we'll send instructions to reset your password",b.resetPassword=function(a){Parse.User.requestPasswordReset(a,{success:function(c){e.getUserByUserName(a).then(function(a){"undefined"!=typeof a?b.userForgot=a.attributes:b.userForgot=null})},error:function(a){b.forgotMessage="Sorry, "+a.message}})},b.goForgot=function(){b.showForgotPassword=!0,b.userForgot=null},b.backToLogin=function(){b.showForgotPassword=null},b.currentUser=Parse.User.current(),null!==b.currentUser&&(b.loginStatus=!0),b.logOut=function(a){b.currentUser=null,Parse.User.logOut(),f.location.reload(),b.loginStatus=null},"undefined"!=typeof g&&(b.option=g)}]);